<!-- Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT License. -->
<!DOCTYPE html>
 <html>

  <head>
    <!-- Office JavaScript API -->
    <script type="text/javascript" src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
    <script type="text/javascript">
    </script>
    <style type='text/css'>
      /* Search Form */
       #search_form{
        margin:0px 0px 8px 0px;
       }
        #search_form #find{
          width:85% !important;
        }
        #search_form .button{
          width: 13% !important;
        }
    </style>
  </head>

  <body>
   <form id='search_form' action='' method='get'>
    <input type='text' name='find' id='find' placeholder='search for...' value=''>
    <input type='submit' class='button' value='search' onclick="search(); alert('7'); return false;">
   </form>

    <!--p>This add-in will insert the text 'Hello world!'.</p-->
    <button id="helloButton">add text</button>

    <!-- The following image URL tracks diagnostic data for this sample add-in. Please remove the image tag if you reuse this sample in your own code project. -->
    <img src="https://pnptelemetry.azurewebsites.net/pnp-officeaddins/samples/word-add-in-hello-world-run" />
</body>

<script>
    Office.onReady((info) => {
        // Check that we loaded into Word
        if (info.host === Office.HostType.Word) {
            document.getElementById("helloButton").onclick = sayHello;
        }
    });

    function sayHello() {
        return Word.run((context) => {

            // insert a paragraph at the start of the document.
            const paragraph = context.document.body.insertParagraph("Hello World", Word.InsertLocation.start);
            
            // sync the context to run the previous API call, and return.
            return context.sync();
        });
    }
 
  
     function search(){
      //varaibles
       var query=null;//query text
       var loop_count=0;//loop counter
       const finds=[];//results container
      //
       //gets the query text
        query=document.getElementById('find').value;
        alert(query);
       //performs the search
        await Word.run(async(context) => {
          const search=context.document.body.search(query);//searches the document
          search.load('font');//loads the font property value
          await context.sync();//syncs the document
          //process the results
           for(loop_count=0; loop_count<search.items.length; loop_count++){//loops through the search results
            search.items[loop_count].font.highlightColor='#FFFF33';//hgihtlights the text
            //search.items[loop_count].font.bold=true;
            //search.items[loop_count].font.italic=true;
           }
           await context.sync();//syncs the document
        });
     }
</script>

</html>
