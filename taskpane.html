<!-- Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT License. -->
<!DOCTYPE html>
 <html>

  <head>
    <!-- Office JavaScript API -->
    <script type="text/javascript" src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
    <style type='text/css'>
      /* Dropdown */
       .dropdown{
        list-style:none;
       }
         .dropdown:hover ul{ display:inline-block; }
        .dropdown li{
         display:inline-block;
        }
        .dropdown ul{
         background-color:rgba(255,255,255, 1);
         border: 1px dotted rgba(181,181,181, 1);
         display:none;
         margin-left:-40px;
         padding: 1px;
         position: absolute;
         text-align:left !important;
        }
         .dropdown ul li{
          display:block !important;
          margin:1px 0px;
         }
      /* Options */
       .op{
        border:0px dotted rgba(181,181,181, 1);
         border-bottom-width:1px;
         border-top-width:1px;
        margin:2px 0px;
        padding:3px 2px 3px 2px;
        text-align:center;
       }
        .op div{ display:inline-block; }
        .op .clear{/* Clear Button */
        }
         .op .clear #clear_button{ height:21px; margin-top:-7.5px !important; vertical-align:top; }
         .op .clear .dropdown ul{ margin-top:14px; }
        .op .color_bx{/* Color Box */
        }
         .op .color_bx .show_bx{
          border:1px solid rgba(0,0,0, 1);
          hegiht:5px;
          width:15px;
         }
         .op .color_bx .preview{
          border:1px solid rgba(0,0,0, 1);
          hegiht:3px;
          width:9px;
         }
         /* ID: Color */
          #color_boxes{
           text-align:center;
           width:auto;
          }
           #color_boxes ul{ margin:0px; padding:0px; }
           #color_boxes .color_line{
            display:inline-block;
            vertical-align:text-top;
            width:9%;
             max-width:17px;
           }
           #color_boxes .color_line .color_line_box{
            border:1px dotted rgba(181,181,181);
             /* border-top-width:0px; */
            display:inline-block;
            height:12px;
            margin:1px 2px 1px 1px;
            width:12px;
           }
            #color_boxes .color_line .first_box{ border-top-width:1px !important; }
            #color_boxes .color_line .first_row{ border-left-width:1px !important; }
            #color_boxes .color_line .last_box{  }
            #color_boxes .color_line .last_row{ }
           /* Palette */
            #color_boxes #color_palette{
             margin:30px 1px 1px 1px;
             position:absolute;
              left:35%;
            }
           /* Selector */
            #color_boxes #color_selector{
             text-align:center;
             margin:2px 2px;
            }
             #color_boxes #color_selector:hover ul{ display:block !important; }
             #color_boxes .color_selector .color_selector_box{
              border:1px dotted rgba(181,181,181);
              display:inline-block;
              height:18px;
              margin:2px 2px 1px 1px;
              width:20px;
             }
             #color_boxes .color_selector .color_selector_name{
              display:inline-block;
              margin:2px 1px 1px 1px;
              text-transform:capitalize;
              vertical-align:top;
             }
      /* Search Form */
       #search_form{
        margin:0px 0px 8px 0px;
       }
        #search_form #find{
          width:70% !important;
        }
        #search_form .button{
          display:none !important;
          width: 25% !important;
        }
    </style>
  </head>

  <body>
   <div id='search_form' action='' method='get'>
    <input type='text' name='find' id='find' placeholder='search for...' value=''>
    <input type='submit' id='search_button' class='button' value='search'>
   </div>
   <div id='options' class='op'>
    <div id='color_boxes' class='color_bx'>
     <!--li id='color_hub' class='dropdown'>
      <div id='color_show_box' class='show_bx' style='background-color:#FFFF00;'>&nbsp;</div>
      <div id='color_show_text' class='show_text'>Yellow</div>
      <ul id='color_list' class='list'>
       <li><div id='color_brown' class='preview' style='background-color:#A52A2A; !important;' hex='A52A2A' rgb='165,42,42'>&nbsp;</div> <div class='color_text'><a onclick="setColor({ color:'brown' })">Brown</a></div></li>
       <li><div id='color_black' class='preview' style='background-color:#000000; !important;' hex='000000' rgb='0,0,0'>&nbsp;</div> <div class='color_text'><a onclick="setColor({ color:'black' })">Black</a></div></li>
       <li><div id='color_blue' class='preview' style='background-color:#0000FF; !important;' hex='0000FF' rgb='0,0,255'>&nbsp;</div> <div class='color_text'><a onclick="setColor({ color:'blue' })">Blue</a></div></li>
       <li><div id='color_cyan' class='preview' style='background-color:#00FFFF; !important;' hex='00FFFF' rgb='0,255,255'>&nbsp;</div> <div class='color_text'><a onclick="setColor({ color:'cyan' })">Cyan</a></div></li>
       <li><div id='color_gray' class='preview' style='background-color:#808080; !important;' hex='808080' rgb='128,128,128'>&nbsp;</div> <div class='color_text'><a onclick="setColor({ color:'gray' })">Gray</a></div></li>
       <li><div id='color_green' class='preview' style='background-color:#008000; !important;' hex='008000' rgb='0,128,0'>&nbsp;</div> <div class='color_text'><a onclick="setColor({ color:'green' })">Green</a></div></li>
       <li><div id='color_orange' class='preview' style='background-color:#FFA500; !important;' hex='FFA500' rgb='255,165,0'>&nbsp;</div> <div class='color_text'><a onclick="setColor({ color:'orange' })">Orange</a></div></li>
       <li><div id='color_pink' class='preview' style='background-color:#FFC0CB; !important;' hex='FFC0CB' rgb='255,192,203'>&nbsp;</div> <div class='color_text'><a onclick="setColor({ color:'pink' })">Pink</a></div></li>
       <li><div id='color_purple' class='preview' style='background-color:#800080; !important;' hex='800080' rgb='128,0,128'>&nbsp;</div> <div class='color_text'><a onclick="setColor({ color:'purple' })">Purple</a></div></li>
       <li><div id='color_red' class='preview' style='background-color:#FF0000; !important;' hex='FF0000' rgb='255,0,0'>&nbsp;</div> <div class='color_text'><a onclick="setColor({ color:'red' })">Red</a></div></li>
       <li><div id='color_yellow' class='preview' style='background-color:#FFFF00; !important;' hex='FFFF00' rgb='255,255,0'>&nbsp;</div> <div class='color_text'><a onclick="setColor({ color:'yellow' })">Yellow</a></div></li>
       <li><div id='color_white' class='preview' style='background-color:#FFFFFF; !important;' hex='FFFFFF' rgb='255,255,255'>&nbsp;</div> <div class='color_text'><a onclick="setColor({ color:'white' })">White</a></div></li>
      </ul>
     </li-->
    </div>
    <div id='clear' class='clear'>
     <li id='clear_dd' class='dropdown'>
      <button id='clear_button'>clear</button>
      <ul id='clear_dd_list' class='list'>
       <li id='clear_all' onclick='clear_dx({ all:true })'>clear all</li>
      </ul>
     </li>
    </div>
   </div>

   <div id='search_list'></div>

    <button id="helloButton" style='margin-top:15px;'>say hi</button>
</body>

<script>
    Office.onReady((info) => {
        // Check that we loaded into Word
        if (info.host === Office.HostType.Word) {
            document.getElementById("helloButton").onclick = sayHello;
            document.getElementById("search_button").setAttribute('style','display:inline-block !important;');
            document.getElementById("search_button").onclick = search;
        }
    });
 
    //variables
     //var highlight_color='FFFF00';//highlight color - defaults to yellow
     const results=[];//search results
     const res_info=[];//results info
     //colors
      const colors={
       //blue
        'blue':{
         'powder_blue': { 'index':'', 'o_index':'', 'hex':'B0E0E6', 'rgb':'176,244,230', 'name':'powder blue' },
         'light_blue': { 'index':'', 'o_index':'', 'hex':'ADD8E6', 'rgb':'173,216,230', 'name':'light blue' },
         'light_sky_blue': { 'index':'', 'o_index':'', 'hex':'87CEFA', 'rgb':'135,206,250', 'name':'light sky blue' },
         'sky_blue': { 'index':'', 'o_index':'', 'hex':'87CEEB', 'rgb':'135,206,235', 'name':'sky blue' },
         'deep_sky_blue': { 'index':'', 'o_index':'', 'hex':'00BFFF', 'rgb':'0,191,255', 'name':'deep sky blue' },
         'light_steel_blue': { 'index':'', 'o_index':'', 'hex':'B0C4DE', 'rgb':'176,196,222', 'name':'light steel blue' },
         'dodger_blue': { 'index':'', 'o_index':'', 'hex':'1E90FF', 'rgb':'30,144,255', 'name':'dodger blue' },
         'cornflower_blue': { 'index':'', 'o_index':'', 'hex':'6495ED', 'rgb':'100,149,237', 'name':'cornflower blue' },
    'steel_blue': { 'index':'', 'o_index':'', 'hex':'4682B4', 'rgb':'70,130,180', 'name':'steel blue' },
    'royal_blue': { 'index':'', 'o_index':'', 'hex':'4169E1', 'rgb':'65,105,225', 'name':'royal blue' },
    'blue': { 'index':'', 'o_index':'', 'hex':'0000FF', 'rgb':'0,0,255', 'name':'blue' },
    'medium_blue': { 'index':'', 'o_index':'', 'hex':'0000CD', 'rgb':'0,0,205', 'name':'medium blue' },
    'dark_blue': { 'index':'', 'o_index':'', 'hex':'00008B', 'rgb':'0,0,139', 'name':'dark blue' },
    'navy': { 'index':'', 'o_index':'', 'hex':'000080', 'rgb':'0,0,128', 'name':'navy' },
    'midnight_blue': { 'index':'', 'o_index':'', 'hex':'191970', 'rgb':'25,25,112', 'name':'midnight blue' },
    'medium_slate_blue': { 'index':'', 'o_index':'', 'hex':'7B68EE', 'rgb':'123,104,238', 'name':'medium slate blue' },
    'slate_blue': { 'index':'', 'o_index':'', 'hex':'6A5ACD', 'rgb':'106,90,205', 'name':'slate blue' },
    'dark_slate_blue': { 'index':'', 'o_index':'', 'hex':'483D8B', 'rgb':'72,61,139', 'name':'dark slate blue' }
   },
  //brown
   'brown':{
    'cornslik': { 'index':'', 'o_index':'', 'hex':'FFF8DC', 'rgb':'255,248,220', 'name':'cornslik' },
    'blanched_dalmond': { 'index':'', 'o_index':'', 'hex':'FFEBCD', 'rgb':'255,235,205', 'name':'blanched dalmond' },
    'bisque': { 'index':'', 'o_index':'', 'hex':'FFE4C4', 'rgb':'255,228,196', 'name':'bisque' },
    'navajo_white': { 'index':'', 'o_index':'', 'hex':'FFDEAD', 'rgb':'255,222,173', 'name':'navajo white' },
    'wheat': { 'index':'', 'o_index':'', 'hex':'F5DEB3', 'rgb':'245,222,179', 'name':'wheat' },
    'burly_wood': { 'index':'', 'o_index':'', 'hex':'DEB887', 'rgb':'222,184,135', 'name':'burly wood' },
    'tan': { 'index':'', 'o_index':'', 'hex':'D2B48C', 'rgb':'210,180,140', 'name':'tan' },
    'rosy_brown': { 'index':'', 'o_index':'', 'hex':'BC8F8F', 'rgb':'188,143,143', 'name':'rosy brown' },
    'sandy_brown': { 'index':'', 'o_index':'', 'hex':'F4A460', 'rgb':'244,164,96', 'name':'sandy brown' },
    'golden_rod': { 'index':'', 'o_index':'', 'hex':'DAA520', 'rgb':'218,165,32', 'name':'golden rod' },
    'peru': { 'index':'', 'o_index':'', 'hex':'CD853F', 'rgb':'205,133,63', 'name':'peru' },
    'chocolate': { 'index':'', 'o_index':'', 'hex':'D2691E', 'rgb':'210,105,30', 'name':'chocolate' },
    'saddle_brown': { 'index':'', 'o_index':'', 'hex':'8B4513', 'rgb':'139,69,19', 'name':'saddle brown' },
    'sienna': { 'index':'', 'o_index':'', 'hex':'A0522D', 'rgb':'160,82,45', 'name':'sienna' },
    'brown': { 'index':'', 'o_index':'', 'hex':'A52A2A', 'rgb':'165,42,42', 'name':'brown' },
    'maroon': { 'index':'', 'o_index':'', 'hex':'800000', 'rgb':'128,0,0', 'name':'maroon' }
   },
  //cyan
   'cyan':{
    'light_cyan': { 'index':'', 'o_index':'', 'hex':'E0FFFF', 'rgb':'224,255,255', 'name':'light cyan' },
    'cyan': { 'index':'', 'o_index':'', 'hex':'00FFFF', 'rgb':'0,255,255', 'name':'cyan' },
    'aqua': { 'index':'', 'o_index':'', 'hex':'00FFFF', 'rgb':'0,255,255', 'name':'aqua' },
    'aquamarine': { 'index':'', 'o_index':'', 'hex':'7FFFD4', 'rgb':'127,255,212', 'name':'aquamarine' },
    'medium_aquamarine': { 'index':'', 'o_index':'', 'hex':'66CDAA', 'rgb':'102,205,170', 'name':'medium aquamarine' },
    'pale_turquoise': { 'index':'', 'o_index':'', 'hex':'AFEEEE', 'rgb':'175,238,238', 'name':'pale turquoise' },
    'turquoise': { 'index':'', 'o_index':'', 'hex':'40E0D0', 'rgb':'64,224,208', 'name':'turquoise' },
    'medium_turquoise': { 'index':'', 'o_index':'', 'hex':'48D1CC', 'rgb':'72,209,204', 'name':'medium turquoise' },
    'dark_turquoise': { 'index':'', 'o_index':'', 'hex':'00CED1', 'rgb':'0,206,209', 'name':'dark turquoise' },
    'light_seagreen': { 'index':'', 'o_index':'', 'hex':'20B2AA', 'rgb':'32,178,170', 'name':'light seagreen' },
    'cadet_blue': { 'index':'', 'o_index':'', 'hex':'5F9EA0', 'rgb':'95,158,160', 'name':'cadet blue' },
    'dark_cyan': { 'index':'', 'o_index':'', 'hex':'008B8B', 'rgb':'0,139,139', 'name':'dark cyan' },
    'teal': { 'index':'', 'o_index':'', 'hex':'008080', 'rgb':'0,128,128', 'name':'teal' }
   },
  //gray
   'gray':{
    'gainsboro': { 'index':'', 'o_index':'', 'hex':'DCDCDC', 'rgb':'220,220,220', 'name':'gainsboro' },
    'light_gray': { 'index':'', 'o_index':'', 'hex':'D3D3D3', 'rgb':'211,211,211', 'name':'light gray' },
    'silver': { 'index':'', 'o_index':'', 'hex':'C0C0C0', 'rgb':'192,192,192', 'name':'silver' },
    'dark_gray': { 'index':'', 'o_index':'', 'hex':'A9A9A9', 'rgb':'169,169,169', 'name':'dark gray' },
    'gray': { 'index':'', 'o_index':'', 'hex':'808080', 'rgb':'128,128,128', 'name':'gray' },
    'dim_gray': { 'index':'', 'o_index':'', 'hex':'696969', 'rgb':'105,105,105', 'name':'dim gray' },
    'light_slate_gray': { 'index':'', 'o_index':'', 'hex':'778899', 'rgb':'119,136,153', 'name':'light slate gray' },
    'slate_gray': { 'index':'', 'o_index':'', 'hex':'708090', 'rgb':'112,128,144', 'name':'slate gray' },
    'dark_slate_gray': { 'index':'', 'o_index':'', 'hex':'2F4F4F', 'rgb':'47,79,79', 'name':'dark slate gray' },
    'black': { 'index':'', 'o_index':'', 'hex':'000000', 'rgb':'0,0,0', 'name':'black' }
   },
  //green
   'green':{
    'lawn_green': { 'index':'', 'o_index':'', 'hex':'7CFC00', 'rgb':'124,252,0', 'name':'lawn green' },
    'chartreuse': { 'index':'', 'o_index':'', 'hex':'7FFF00', 'rgb':'127,255,0', 'name':'chartreuse' },
    'lime_green': { 'index':'', 'o_index':'', 'hex':'32CD32', 'rgb':'50,205,50', 'name':'lime green' },
    'lime': { 'index':'', 'o_index':'', 'hex':'00FF00', 'rgb':'0,255,0', 'name':'lime' },
    'forest_green': { 'index':'', 'o_index':'', 'hex':'228B22', 'rgb':'34,139,34', 'name':'forest green' },
    'green': { 'index':'', 'o_index':'', 'hex':'008000', 'rgb':'0,128,0', 'name':'green' },
    'dark_green': { 'index':'', 'o_index':'', 'hex':'006400', 'rgb':'0,100,0', 'name':'dark_green' },
    'green_yellow': { 'index':'', 'o_index':'', 'hex':'ADFF2F', 'rgb':'173,255,47', 'name':'green yellow' },
    'yellow_green': { 'index':'', 'o_index':'', 'hex':'9ACD32', 'rgb':'154,205,50', 'name':'yellow green' },
    'spring_green': { 'index':'', 'o_index':'', 'hex':'00FF7F', 'rgb':'0,255,127', 'name':'spring green' },
    'medium_spring_green': { 'index':'', 'o_index':'', 'hex':'00FA9A', 'rgb':'0,250,154', 'name':'medium spring green' },
    'light_green': { 'index':'', 'o_index':'', 'hex':'90EE90', 'rgb':'144,238,144', 'name':'light green' },
    'pale_green': { 'index':'', 'o_index':'', 'hex':'98FB98', 'rgb':'152,251,152', 'name':'pale green' },
    'dark_seagreen': { 'index':'', 'o_index':'', 'hex':'8FBC8F', 'rgb':'143,188,143', 'name':'dark seagreen' },
    'medium_seagreen': { 'index':'', 'o_index':'', 'hex':'3CB371', 'rgb':'60,179,113', 'name':'medium seagreen' },
    'seagreen': { 'index':'', 'o_index':'', 'hex':'2E8B57', 'rgb':'46,139,87', 'name':'seagreen' },
    'olive': { 'index':'', 'o_index':'', 'hex':'808000', 'rgb':'128,128,0', 'name':'olive' },
    'dark_olive_green': { 'index':'', 'o_index':'', 'hex':'556B2F', 'rgb':'85,107,47', 'name':'dark olive green' },
    'olive_drab': { 'index':'', 'o_index':'', 'hex':'6B8E23', 'rgb':'107,142,35', 'name':'olive drab' }
   },
  //orange
   'orange':{
    'coral': { 'index':'', 'o_index':'', 'hex':'FF7F50', 'rgb':'255,127,80', 'name':'coral' },
    'tomato': { 'index':'', 'o_index':'', 'hex':'FF6347', 'rgb':'255,99,71', 'name':'tomato' },
    'orange_red': { 'index':'', 'o_index':'', 'hex':'FF4500', 'rgb':'255,69,0', 'name':'orange red' },
    'gold': { 'index':'', 'o_index':'', 'hex':'FFD700', 'rgb':'255,215,0', 'name':'gold' },
    'orange': { 'index':'', 'o_index':'', 'hex':'FFA500', 'rgb':'255,165,0', 'name':'orange' },
    'dark_orange': { 'index':'', 'o_index':'', 'hex':'FF8C00', 'rgb':'255,140,0', 'name':'dark orange' }
   },
  //purple
   'purple':{
    'lavender': { 'index':'', 'o_index':'', 'hex':'E6E6FA', 'rgb':'230,230,250', 'name':'lavender' },
    'thistle': { 'index':'', 'o_index':'', 'hex':'D8BFD8', 'rgb':'216,191,216', 'name':'thistle' },
    'plum': { 'index':'', 'o_index':'', 'hex':'DDA0DD', 'rgb':'221,160,221', 'name':'plum' },
    'violet': { 'index':'', 'o_index':'', 'hex':'EE82EE', 'rgb':'238,130,238', 'name':'violet' },
    'orchid': { 'index':'', 'o_index':'', 'hex':'DA70D6', 'rgb':'218,112,214', 'name':'orchid' },
    'fuchisa': { 'index':'', 'o_index':'', 'hex':'FF00FF', 'rgb':'255,0,255', 'name':'fuchsia' },
    'magenta': { 'index':'', 'o_index':'', 'hex':'FF00FF', 'rgb':'255,0,255', 'name':'magenta' },
    'medium_orchid': { 'index':'', 'o_index':'', 'hex':'BA55D3', 'rgb':'186,85,211', 'name':'medium orchid' },
    'medium_purple': { 'index':'', 'o_index':'', 'hex':'9370DB', 'rgb':'147,112,219', 'name':'medium purple' },
    'blue_violet': { 'index':'', 'o_index':'', 'hex':'8A2BE2', 'rgb':'138,43,226', 'name':'blue violet' },
    'dark_violet': { 'index':'', 'o_index':'', 'hex':'9400D3', 'rgb':'148,0,211', 'name':'dark violet' },
    'dark_orchid': { 'index':'', 'o_index':'', 'hex':'9932CC', 'rgb':'153,50,204', 'name':'dark orchid' },
    'dark_magenta': { 'index':'', 'o_index':'', 'hex':'8B008B', 'rgb':'139,0,139', 'name':'dark magenta' },
    'purple': { 'index':'', 'o_index':'', 'hex':'800080', 'rgb':'128,0,128', 'name':'purple' },
    'indigo': { 'index':'', 'o_index':'', 'hex':'4B0082', 'rgb':'75,0,130', 'name':'indigo' }
   },
  // pink
   'pink':{
    'pink': { 'index':'', 'o_index':'', 'hex':'FFC0CB', 'rgb':'255,192,203', 'name':'pink' },
    'light pink': { 'index':'', 'o_index':'', 'hex':'FFB6C1', 'rgb':'255,182,193', 'name':'light pink' },
    'hot_pink': { 'index':'', 'o_index':'', 'hex':'FF69B4', 'rgb':'255,105,180', 'name':'hot pink' },
    'deep_pink': { 'index':'', 'o_index':'', 'hex':'FF1493', 'rgb':'255,20,147', 'name':'deep pink' },
    'pale_violet_red': { 'index':'', 'o_index':'', 'hex':'DB7093', 'rgb':'219,112,147', 'name':'pale violet red' },
    'medium_violet_red': { 'index':'', 'o_index':'', 'hex':'C71585', 'rgb':'199,21,133', 'name':'medium violet red' }
   },
  //red
   'red':{
    'light_salmon': { 'index':'', 'o_index':'', 'hex':'FFA07A', 'rgb':'255,160,122', 'name':'light salmon' },
    'salmon': { 'index':'', 'o_index':'', 'hex':'FA8072', 'rgb':'250,128,114', 'name':'salmon' },
    'dark_salmon': { 'index':'', 'o_index':'', 'hex':'E9967A', 'rgb':'233,150,122', 'name':'dark salmon' },
    'light_coral': { 'index':'', 'o_index':'', 'hex':'F08080', 'rgb':'240,128,128', 'name':'light coral' },
    'indian_red': { 'index':'', 'o_index':'', 'hex':'CD5C5C', 'rgb':'205,92,92', 'name':'indian red' },
    'crimson': { 'index':'', 'o_index':'', 'hex':'DC143C', 'rgb':'220,20,60', 'name':'crimson' },
    'firebrick': { 'index':'', 'o_index':'', 'hex':'B22222', 'rgb':'178,34,34', 'name':'firebrick' },
    'red': { 'index':'', 'o_index':'', 'hex':'FF0000', 'rgb':'255,0,0', 'name':'red' },
    'dark_red': { 'index':'', 'o_index':'', 'hex':'8B0000', 'rgb':'139,0,0', 'name':'dark red' }
   },
  //white
   'white':{
    'white': { 'index':'', 'o_index':'', 'hex':'FFFFFF', 'rgb':'255,255,255', 'name':'white' },
    'snow': { 'index':'', 'o_index':'', 'hex':'FFFAFA', 'rgb':'255,250,250', 'name':'snow' },
    'honeydew': { 'index':'', 'o_index':'', 'hex':'F0FFF0', 'rgb':'240,255,240', 'name':'honeydew' },
    'mint_cream': { 'index':'', 'o_index':'', 'hex':'F5FFFA', 'rgb':'245,255,250', 'name':'mint cream' },
    'azure': { 'index':'', 'o_index':'', 'hex':'F0FFFF', 'rgb':'240,255,255', 'name':'azure' },
    'alice_blue': { 'index':'', 'o_index':'', 'hex':'F0F8FF', 'rgb':'240,248,255', 'name':'alice blue' },
    'ghost_white': { 'index':'', 'o_index':'', 'hex':'F8F8FF', 'rgb':'248,248,255', 'name':'ghost white' },
    'white_smoke': { 'index':'', 'o_index':'', 'hex':'F5F5F5', 'rgb':'245,245,245', 'name':'white smoke' },
    'seashell': { 'index':'', 'o_index':'', 'hex':'FFF5EE', 'rgb':'255,245,238', 'name':'seashell' },
    'beige': { 'index':'', 'o_index':'', 'hex':'F5F5DC', 'rgb':'245,245,220', 'name':'beige' },
    'old_lace': { 'index':'', 'o_index':'', 'hex':'FDF5E6', 'rgb':'253,245,230', 'name':'old lace' },
    'floral_white': { 'index':'', 'o_index':'', 'hex':'FFFAF0', 'rgb':'255,250,240', 'name':'floral white' },
    'ivory': { 'index':'', 'o_index':'', 'hex':'FFFFF0', 'rgb':'255,255,240', 'name':'ivory' },
    'antique_white': { 'index':'', 'o_index':'', 'hex':'FAEBD7', 'rgb':'250,235,215', 'name':'antique white' },
    'linen': { 'index':'', 'o_index':'', 'hex':'FAF0E6', 'rgb':'250,240,230', 'name':'linen' },
    'lavender_blush': { 'index':'', 'o_index':'', 'hex':'FFF0F5', 'rgb':'255,240,245', 'name':'lavender blush' },
    'misty_rose': { 'index':'', 'o_index':'', 'hex':'FFE4E1', 'rgb':'255,228,225', 'name':'misty rose' }
   },
  //yellow
   'yellow': {
    'light_yellow': { 'index':'', 'o_index':'', 'hex':'FFFFE0', 'rgb':'255,255,224', 'name':'light yellow' },
    'lemon_chiffon': { 'index':'', 'o_index':'', 'hex':'FFFACD', 'rgb':'255,250,205', 'name':'lemon chiffon' },
    'light_golden_rod_yellow': { 'index':'', 'o_index':'FAFAD2', 'hex':'250,250,210', 'rgb':'', 'name':'light golden rod yellow' },
    'papaya_whip': { 'index':'', 'o_index':'', 'hex':'FFEFD5', 'rgb':'255,239,213', 'name':'papaya whip' },
    'moccasin': { 'index':'', 'o_index':'', 'hex':'FFE4B5', 'rgb':'255,228,181', 'name':'moccasin' },
    'peach_puff': { 'index':'', 'o_index':'', 'hex':'FFDAB9', 'rgb':'255,218,185', 'name':'peach_puff' },
    'pale_golden_rod': { 'index':'', 'o_index':'', 'hex':'EEE8AA', 'rgb':'238,232,170', 'name':'pale golden rod' },
    'khaki': { 'index':'', 'o_index':'', 'hex':'F0E68C', 'rgb':'240,230,140', 'name':'khaki' },
    'dark_khaki': { 'index':'', 'o_index':'', 'hex':'BDB76B', 'rgb':'189,183,107', 'name':'dark khaki' },
    'yellow': { 'index':'', 'o_index':'', 'hex':'FFFF00', 'rgb':'255,255,0', 'name':'yellow' }
   }
 };
     //color build
      const color_list=[];//builds the color list
      color_groups=(Object.keys(colors).length);//gets the amount of color groups
      //color_groups_keys=Object.keys(colors);//top group color names //<- orders by the way coded
       color_groups_keys=[ 'green', 'blue', 'white', 'brown', 'purple', 'cyan', 'gray', 'yellow', 'red', 'orange', 'pink' ];//order by way written 
      color_groups_n_name=[];//nested group color names
      color_groups_n_count=0;//color group count
      //group count
       for(cg_cnt=0; cg_cnt<color_groups; cg_cnt++){//loops through the top group and gets the nested group values
        //vars
         //
          var cg_n_cnt=0;//nested count
          var cur_color=color_groups_keys[cg_cnt];//gets the current color
          var cur_color_count=(Object.keys(colors[cur_color]).length);//gets the current color list count
          var cur_color_keys=Object.keys(colors[cur_color]);//gets the current color keys
         //stores the color names
          //if(typeof(cur_color)=='string'){
           var clr_list=colors[cur_color];//gets the current color list
           for(cg_n_cnt=0; cg_n_cnt<cur_color_count; cg_n_cnt++){//loops through the color nested list
            //if the first element in an array
             if(cg_n_cnt==0){ color_groups_n_name[cur_color]=[]; }//makes the storage an array
            //
             color_groups_n_name[cur_color][cg_n_cnt]=cur_color_keys[cg_n_cnt];//stores the nested color name
           } 
          //}
       }
      //color palette build
       var color_boxes="";
       var fl_selector=null;
       var highlight_color=colors['yellow']['yellow'].hex;//sets the hightlight color
       var highlight_color_name=colors['yellow']['yellow'].name;//sets the hightlight color name
       
      //
       //builds the color selector
        color_boxes+="<ul><li class='dropdown'>";//dropdown
         color_boxes+="<div id='color_selector' class='color_selector dropdown'>";
          color_boxes+="<div id='color_selector_box' class='color_selector_box' style='background-color:#"+highlight_color+";'></div>";
          color_boxes+="<div id='color_selector_name' class='color_selector_name'>"+highlight_color_name+"</div>";
         color_boxes+="</div>";
       //builds the color palette
        color_boxes+="<ul id='color_palette'>";
        //
         for(bx_cnt=0; bx_cnt<color_groups; bx_cnt++){
          //vars
           var main_color_name=color_groups_keys[bx_cnt];
          //creates the color box start
           color_boxes+="<div id='color_line_"+main_color_name+"' class='color_line'>";
          for(ibx_cnt=0; ibx_cnt<( color_groups_n_name[main_color_name].length ); ibx_cnt++){
           var sel_color_name=color_groups_n_name[main_color_name][ibx_cnt];
           //pulls from the color main object
            var sel_color_oname=colors[main_color_name][sel_color_name].name;
            var sel_color_hex=colors[main_color_name][sel_color_name].hex;//gets the color
           //builds the color box
            //first/last selector
             if(ibx_cnt===0){ fl_selector='first_box'; }
             else if(ibx_cnt===((color_groups_n_name[main_color_name].length)-1)){ fl_selector='last_box'; }
            color_boxes+="<div";
             color_boxes+=" id='color_line_"+main_color_name+"_"+sel_color_name+"' style='background-color:#"+sel_color_hex+";' alt='"+sel_color_oname+"'";
             color_boxes+=" onmouseover='set({ \"obj\":\"preview_color\", \"color\":\""+sel_color_hex+"\", \"color_name\":\""+sel_color_oname+"\" })'";
             color_boxes+=" onmouseout='set({ \"obj\":\"preview_default_color\" })'";
             color_boxes+=' onclick=\' set({ "obj":"color_change", "color":"'+sel_color_hex+'", "color_name":"'+sel_color_oname+'" }) \'';
             color_boxes+=" class='color_line_box "+fl_selector+"'>";
            color_boxes+="</div>";
          }
          color_boxes+="</div>";//closes the color box
         }
        color_boxes+="</ul></li></ul>";//closes the color palette
       //draws the color boxes
        document.getElementById('color_boxes').innerHTML=color_boxes;

      function set(attrs){
       //variables
        var obj=(attrs.obj) || (attrs.objective) || null;//objective
       //
        //checks the objective
         if(obj!=null){
          //color setting
           if(obj=='color_change' || obj=='color change'){//changes the highlight color
            //vars
             var set_color=(attrs.color) || null;
             var set_color_name=(attrs.color_name) || (attrs['color name']) || null;
            //
             //changes the highlight color
              highlight_color=set_color;
              highlight_color_name=set_color_name;
           }
           else if(obj=='preview_color' || obj=='preview color'){//changes the preview box color
            //vars
             var set_color=(attrs.color) || null;
             var set_color_name=(attrs.color_name) || (attrs['color name']) || null;
            //
             //gets the color if just based on color name
             
             document.getElementById('color_selector_box').setAttribute('style','background-color:#'+set_color+';');
             document.getElementById('color_selector_name').innerHTML = set_color_name;
           }
           else if(obj=='preview_default_color' || obj=='preview default color'){//defaults the preview color box to the highlight color
            document.getElementById('color_selector_box').setAttribute('style','background-color:#'+highlight_color+';');
            document.getElementById('color_selector_name').innerHTML = highlight_color_name;
           }
         }
      }

    function sayHello() {
        return Word.run((context) => {

            // insert a paragraph at the start of the document.
            const paragraph = context.document.body.insertParagraph("Hello World", Word.InsertLocation.start);
            
            // sync the context to run the previous API call, and return.
            return context.sync();
        });
    }

    function tracker(attrs){
     //vars
      var obj=(attrs.obj) || (attrs.objective) || null;
     //
      //checks the objective
       if(obj=='add_clear'||obj=='add_search'){//adds a search to the clear list
        //vals
         var res_index=(attrs.result) || (attrs.result_index) || (attrs.index) || null;//result index
         var srh_query=(attrs.search) || (attrs.query) || null;//search query
          var srh_query_c=srh_query.replace("'", "\'");//text sterilization
         var add_exists=document.getElementById('clear_dx_'+srh_query_c);
         var add_already=null;//
          if(add_exists!=null){ var add_check=add_exists.getAttribute('set'); if(add_check==1){ add_already=true; } }
         var fx_box=null; var el_start=null; var el_end=null;//focus box, start & end element tags
          if(obj=='add_search'){ fx_box='search_list'; el_start='<div>'; el_end='</div>'; }
          else{ fx_box='clear_dd_list'; el_start='<li>'; el_end='</li>'; }
        //
         //checks if the query was already added
          if(add_already===null){
           //builds the clearage link
            var cur_doc=document.getElementById(fx_box).innerHTML;//gets the clear list content
            var new_clear=el_start+"<a id='clear_dx_"+srh_query_c+"' set='1' onclick='clear_dx({ index:\''+res_index+'\' });'>"+srh_query+"</a>"+el_end;
            var new_doc=cur_doc + new_clear;//appends the new clear link to the clear list
            //adds the clearage link
             document.getElementById(fx_box).innerHTML = new_doc;//updates the clear list
          }
       }
    }

    function clear_dx(attrs){//clears searches
     //vars
      var all=(attrs.all) || (attrs.clear_all) || (attrs['clear all']) || null;//clear all flag
      var index=(attrs.index) || (attrs.result) || (attrs.result_index) || (attrs['result index']) || (attrs.res_index) || (attrs['res index']) || null;//result index
     //checks what to do
      if(all===true){//if all highlight are to be cleared
       
      }
      else{//regular individual clearance
       if(index!=null){//if a non-empty index has been provided
       }
      }
    }
 
    function setColor(attrs){
     //vars
      var color=attrs.color;//the color
      var hex=attrs.hex;//color hex
      var rgb=attrs.rgb;//color rgb
      var alpha=attrs.alpha;//color rgb alpha
     //
      //attempts to get the color hex & rgb
       var h_color=document.getElementById('color_'+color).getAttribute('hex');//gets the hex color
       var rgb_color=document.getElementById('color_'+color).getAttribute('rgb');//gets the hex color
      //changes the color
       highlight_color='#' + h_color;//attemps to change the highlight color
       var color_name_upper=(color[0].toUpperCase())+(color.slice(1));
       //changes the color display box
        document.getElementById('color_show_box').setAttribute('style','background-color: #'+h_color+' !important;');
        document.getElementById('color_show_text').innerHTML=color_name_upper;
       //changes the highlight color
        highlight_color=h_color;
    }
  
     function search(){
      //varaibles
       var query=null;//query text
       var loop_count=0;//loop counter
       var hl_color=highlight_color;//set the highlight color to reference the main one
       const finds=[];//results container
       console.log(hl_color+' | '+highlight_color);
      //
       //gets the query text
        query=document.getElementById('find').value;
       //performs the search
        return Word.run(async(context) => {
          const search=context.document.body.search(query);//searches the document
          //stores the search results
           var si=results.length;//gets the result index
            if(si<0){ si=0; }
           results[si]=search;//storage
           res_info[si]=[//results info allocation
            false,//0: search performance
            null,//1: highlight flag
            null,//2: highlight color
           ];
          search.load('font');//loads the font property value
          await context.sync();//syncs the document
          //adds the search to the search & clear list
           tracker({ index:loop_count, query:query, obj:'add_clear' });
           tracker({ index:loop_count, query:query, obj:'add_search' });
          //clears the last search results
           var c_counter=0;//clear counter
           var csi=(si<=0) ? 0 : (si-1);
           var c_m_counter=(results[(csi)]).items.length;//gets the counter length
           for(c_counter=0; c_counter<c_m_counter; c_counter++){//loops through the old search results and removes the highlight
            search.items[c_counter].font.highlightColor='#' + hl_color;//removes the highlight
           }
           //
          //process the results
           for(loop_count=0; loop_count<search.items.length; loop_count++){//loops through the search results
            search.items[loop_count].font.highlightColor='#'+hl_color;//hgihtlights the text
            //adds the result info
             res_info[si][loop_count]=[ true, 1, hl_color ];
              //res_info[si][loop_count][1]=true;//sets the results true flag
              //res_info[si][loop_count][2]=hl_color;//sets the results true flag
             console.log(res_info[si][loop_count]);
            //search.items[loop_count].font.bold=true;
            //search.items[loop_count].font.italic=true;
           }
           return context.sync();//syncs the document
        });
     }
</script>

</html>
